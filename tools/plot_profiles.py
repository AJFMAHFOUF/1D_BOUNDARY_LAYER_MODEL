import numpy as np
import matplotlib.pyplot as plt
expid='REF005'
z,t,q,u,v,km,kh=np.loadtxt('../data_out/atmospheric_profiles_exp_'+expid+'.dat',unpack=True)
za=np.reshape(z,(17,80))
ta=np.reshape(t,(17,80))
qa=np.reshape(q,(17,80))
ua=np.reshape(u,(17,80))
va=np.reshape(v,(17,80))
kma=np.reshape(km,(17,80))
kha=np.reshape(kh,(17,80))
fig=plt.figure()
ax1=fig.add_subplot(221)
ax1.plot(ta[0,:]-273.15,za[0,:],label='09 LST',linewidth=2)
ax1.plot(ta[1,:]-273.15,za[1,:],label='12 LST',linewidth=2)
ax1.plot(ta[2,:]-273.15,za[2,:],label='15 LST',linewidth=2)
ax1.plot(ta[3,:]-273.15,za[2,:],label='18 LST',linewidth=2)
ax1.set_ylim(0.,2000.)
ax1.legend(loc='best',fontsize='small')
ax1.set_xlabel('Potential temperature (Â°C)')
ax1.set_ylabel('Height (m)')
ax2=fig.add_subplot(222)
ax2.plot(qa[0,:]*1.E3,za[0,:],label='09 LST',linewidth=2)
ax2.plot(qa[1,:]*1.E3,za[1,:],label='12 LST',linewidth=2)
ax2.plot(qa[2,:]*1.E3,za[2,:],label='15 LST',linewidth=2)
ax2.plot(qa[3,:]*1.E3,za[2,:],label='18 LST',linewidth=2)
ax2.set_ylim(0.,2000.)
ax2.legend(loc='best',fontsize='small')
ax2.set_xlabel('Specific humidity (k/kg)')
#ax2.set_ylabel('Height (m)')
ax3=fig.add_subplot(223)
ax3.plot(ua[0,:],za[0,:],label='09 LST',linewidth=2)
ax3.plot(ua[1,:],za[1,:],label='12 LST',linewidth=2)
ax3.plot(ua[2,:],za[2,:],label='15 LST',linewidth=2)
ax3.plot(ua[3,:],za[2,:],label='18 LST',linewidth=2)
ax3.set_ylim(0.,2000.)
ax3.legend(loc='best',fontsize='small')
ax3.set_xlabel('Zonal wind (m/s)')
ax3.set_ylabel('Height (m)')
ax4=fig.add_subplot(224)
ax4.plot(va[0,:],za[0,:],label='09 LST',linewidth=2)
ax4.plot(va[1,:],za[1,:],label='12 LST',linewidth=2)
ax4.plot(va[2,:],za[2,:],label='15 LST',linewidth=2)
ax4.plot(va[3,:],za[2,:],label='18 LST',linewidth=2)
ax4.set_ylim(0.,2000.)
ax4.legend(loc='best',fontsize='small')
ax4.set_xlabel('Meridional wind (m/s)')
#ax4.set_ylabel('Height (m)')
figure = plt.gcf()
figure.set_size_inches(7, 11)
plt.savefig('../plots/Figure1_'+expid,dpi=600)
plt.show()

