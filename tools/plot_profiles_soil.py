import numpy as np
import matplotlib.pyplot as plt
nlevs=14
expid='REF004'
zs,ts,ws,ls,dw=np.loadtxt('../data_out/soil_profiles_exp_'+expid+'.dat',unpack=True)
zs1=np.reshape(zs,(17,nlevs))
ts1=np.reshape(ts,(17,nlevs))
ws1=np.reshape(ws,(17,nlevs))
ls1=np.reshape(ls,(17,nlevs))
dw1=np.reshape(dw,(17,nlevs))
fig=plt.figure()
ax1=fig.add_subplot(221)
ax1.plot(ts1[0,:]-273.15,zs1[0,:],label='09 LST',linewidth=2)
ax1.plot(ts1[1,:]-273.15,zs1[1,:],label='12 LST',linewidth=2)
ax1.plot(ts1[2,:]-273.15,zs1[2,:],label='15 LST',linewidth=2)
ax1.plot(ts1[3,:]-273.15,zs1[2,:],label='18 LST',linewidth=2)
ax1.plot(ts1[4,:]-273.15,zs1[0,:],label='21 LST',linewidth=2)
ax1.plot(ts1[5,:]-273.15,zs1[1,:],label='00 LST',linewidth=2)
ax1.plot(ts1[6,:]-273.15,zs1[2,:],label='03 LST',linewidth=2)
ax1.plot(ts1[7,:]-273.15,zs1[2,:],label='06 LST',linewidth=2)
ax1.set_ylim(1.,0.)
ax1.legend(loc='best',fontsize='small')
ax1.set_xlabel('Soil temperature (Â°C)')
ax1.set_ylabel('Depth (m)')
ax2=fig.add_subplot(222)
ax2.plot(ws1[0,:],zs1[0,:],label='09 LST',linewidth=2)
ax2.plot(ws1[1,:],zs1[1,:],label='12 LST',linewidth=2)
ax2.plot(ws1[2,:],zs1[2,:],label='15 LST',linewidth=2)
ax2.plot(ws1[3,:],zs1[2,:],label='18 LST',linewidth=2)
ax2.plot(ws1[4,:],zs1[0,:],label='21 LST',linewidth=2)
ax2.plot(ws1[5,:],zs1[1,:],label='00 LST',linewidth=2)
ax2.plot(ws1[6,:],zs1[2,:],label='03 LST',linewidth=2)
ax2.plot(ws1[7,:],zs1[2,:],label='06 LST',linewidth=2)
ax2.set_ylim(1.,0.)
ax2.legend(loc='best',fontsize='small')
ax2.set_xlabel('Soil moisture content (m3/m3)')
#ax2.set_ylabel('Height (m)')
ax3=fig.add_subplot(223)
ax3.plot(ls1[0,:],zs1[0,:],label='09 LST',linewidth=2)
ax3.plot(ls1[1,:],zs1[1,:],label='12 LST',linewidth=2)
ax3.plot(ls1[2,:],zs1[2,:],label='15 LST',linewidth=2)
ax3.plot(ls1[3,:],zs1[2,:],label='18 LST',linewidth=2)
ax3.plot(ls1[4,:],zs1[0,:],label='21 LST',linewidth=2)
ax3.plot(ls1[5,:],zs1[1,:],label='00 LST',linewidth=2)
ax3.plot(ls1[6,:],zs1[2,:],label='03 LST',linewidth=2)
ax3.plot(ls1[7,:],zs1[2,:],label='06 LST',linewidth=2)
ax3.set_ylim(1.,0.)
ax3.legend(loc='best',fontsize='small')
ax3.set_xlabel('Thermal conductivity')
ax3.set_ylabel('Depth (m)')
ax4=fig.add_subplot(224)
ax4.plot(dw1[0,:]*1E6,zs1[0,:],label='09 LST',linewidth=2)
ax4.plot(dw1[1,:]*1E6,zs1[1,:],label='12 LST',linewidth=2)
ax4.plot(dw1[2,:]*1E6,zs1[2,:],label='15 LST',linewidth=2)
ax4.plot(dw1[3,:]*1E6,zs1[2,:],label='18 LST',linewidth=2)
ax4.plot(dw1[4,:]*1E6,zs1[0,:],label='21 LST',linewidth=2)
ax4.plot(dw1[5,:]*1E6,zs1[1,:],label='00 LST',linewidth=2)
ax4.plot(dw1[6,:]*1E6,zs1[2,:],label='03 LST',linewidth=2)
ax4.plot(dw1[7,:]*1E6,zs1[2,:],label='06 LST',linewidth=2)
ax4.set_ylim(1.,0.)
ax4.legend(loc='best',fontsize='small')
ax4.set_xlabel('Hydraulic diffusivity')
#ax4.set_ylabel('Height (m)')
figure = plt.gcf()
figure.set_size_inches(7, 11)
plt.savefig('../plots/Figure3_'+expid,dpi=600)
plt.show()

